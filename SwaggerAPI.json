{
  "swagger": "2.0",
  "info": {
    "version": "1.0.0",
    "title": "Ticket Management API",
    "description": "API de gestion des tickets, utilisateurs, commentaires et médias.",
    "contact": {
      "email": "support@ticketapp.local"
    },
    "license": {
      "name": "MIT"
    }
  },
  "host": "localhost:8000",
  "basePath": "/api",
  "schemes": ["http"],
  "consumes": ["application/json"],
  "produces": ["application/json"],

  "tags": [
    { "name": "Tickets", "description": "Gestion des tickets" },
    { "name": "Commentaires", "description": "Commentaires des tickets" },
    { "name": "Medias", "description": "Images et vidéos associées" },
    { "name": "Utilisateurs", "description": "Gestion des utilisateurs" },
    { "name": "Exportation", "description": "Export de tickets" }
  ],

  "paths": {
    "/tickets": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Liste tous les tickets",
        "operationId": "getTickets",
        "responses": { "200": { "description": "Liste des tickets" } }
      },
      "post": {
        "tags": ["Tickets"],
        "summary": "Crée un nouveau ticket",
        "operationId": "createTicket",
        "parameters": [
          { "in": "body", "name": "body", "required": true, "schema": { "$ref": "#/definitions/Ticket" } }
        ],
        "responses": { "201": { "description": "Ticket créé" } }
      }
    },

    "/tickets/{id}": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Récupère un ticket spécifique",
        "operationId": "getTicketById",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "Ticket trouvé" } }
      },
      "put": {
        "tags": ["Tickets"],
        "summary": "Met à jour un ticket",
        "operationId": "updateTicket",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "integer" },
          { "in": "body", "name": "body", "required": true, "schema": { "$ref": "#/definitions/Ticket" } }
        ],
        "responses": { "200": { "description": "Ticket mis à jour" } }
      },
      "delete": {
        "tags": ["Tickets"],
        "summary": "Supprime un ticket",
        "operationId": "deleteTicket",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "204": { "description": "Ticket supprimé" } }
      }
    },

    "/tickets/findByStatus": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Recherche par statut",
        "parameters": [{ "name": "status", "in": "query", "type": "string", "required": true }],
        "responses": { "200": { "description": "Tickets trouvés" } }
      }
    },
    "/tickets/findByPriority": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Recherche par priorité",
        "parameters": [{ "name": "priority", "in": "query", "type": "string", "required": true }],
        "responses": { "200": { "description": "Tickets trouvés" } }
      }
    },
    "/tickets/findByUser": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Recherche par utilisateur",
        "parameters": [{ "name": "user", "in": "query", "type": "integer", "required": true }],
        "responses": { "200": { "description": "Tickets trouvés" } }
      }
    },
    "/tickets/findByStatusUser": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Recherche par statut et utilisateur",
        "parameters": [
          { "name": "status", "in": "query", "type": "string", "required": true },
          { "name": "user", "in": "query", "type": "integer", "required": true }
        ],
        "responses": { "200": { "description": "Tickets trouvés" } }
      }
    },
    "/tickets/findByTitle": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Recherche par titre",
        "parameters": [{ "name": "title", "in": "query", "type": "string", "required": true }],
        "responses": { "200": { "description": "Tickets trouvés" } }
      }
    },
    "/tickets/unassigned": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Tickets non assignés",
        "responses": { "200": { "description": "Tickets trouvés" } }
      }
    },
    "/tickets/critical": {
      "get": {
        "tags": ["Tickets"],
        "summary": "Tickets critiques",
        "responses": { "200": { "description": "Tickets trouvés" } }
      }
    },

    "/tickets/{id}/assign": {
      "put": {
        "tags": ["Tickets"],
        "summary": "Assigne un ticket à un utilisateur",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "integer" },
          { "name": "userId", "in": "query", "type": "integer", "required": true }
        ],
        "responses": { "200": { "description": "Ticket assigné" } }
      }
    },
    "/tickets/{id}/unassign": {
      "put": {
        "tags": ["Tickets"],
        "summary": "Désassigne un ticket",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "Ticket désassigné" } }
      }
    },
    "/tickets/{id}/close": {
      "put": {
        "tags": ["Tickets"],
        "summary": "Ferme un ticket",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "Ticket fermé" } }
      }
    },

    "/tickets/{id}/comments": {
      "get": {
        "tags": ["Commentaires"],
        "summary": "Liste les commentaires d'un ticket",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "Commentaires listés" } }
      },
      "post": {
        "tags": ["Commentaires"],
        "summary": "Ajoute un commentaire à un ticket",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "integer" },
          { "in": "body", "name": "body", "required": true, "schema": { "$ref": "#/definitions/Comment" } }
        ],
        "responses": { "201": { "description": "Commentaire ajouté" } }
      }
    },

    "/tickets/{id}/image": {
      "get": {
        "tags": ["Medias"],
        "summary": "Voir les images d'un ticket",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "Images renvoyées" } }
      },
      "post": {
        "tags": ["Medias"],
        "summary": "Ajouter une image à un ticket",
        "consumes": ["multipart/form-data"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "integer" },
          { "name": "file", "in": "formData", "required": true, "type": "file" }
        ],
        "responses": { "201": { "description": "Image ajoutée" } }
      }
    },

    "/tickets/{id}/videos": {
      "get": {
        "tags": ["Medias"],
        "summary": "Voir les vidéos d'un ticket",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "Vidéos renvoyées" } }
      },
      "post": {
        "tags": ["Medias"],
        "summary": "Ajouter une vidéo à un ticket",
        "consumes": ["multipart/form-data"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "integer" },
          { "name": "file", "in": "formData", "required": true, "type": "file" }
        ],
        "responses": { "201": { "description": "Vidéo ajoutée" } }
      }
    },

    "/users": {
      "get": {
        "tags": ["Utilisateurs"],
        "summary": "Liste tous les utilisateurs",
        "responses": { "200": { "description": "Liste des utilisateurs" } }
      },
      "post": {
        "tags": ["Utilisateurs"],
        "summary": "Crée un nouvel utilisateur",
        "parameters": [
          { "in": "body", "name": "body", "required": true, "schema": { "$ref": "#/definitions/User" } }
        ],
        "responses": { "201": { "description": "Utilisateur créé" } }
      }
    },

    "/users/{id}": {
      "get": {
        "tags": ["Utilisateurs"],
        "summary": "Récupère un utilisateur spécifique",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "Utilisateur trouvé" } }
      },
      "put": {
        "tags": ["Utilisateurs"],
        "summary": "Met à jour un utilisateur",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "integer" },
          { "in": "body", "name": "body", "required": true, "schema": { "$ref": "#/definitions/User" } }
        ],
        "responses": { "200": { "description": "Utilisateur mis à jour" } }
      },
      "delete": {
        "tags": ["Utilisateurs"],
        "summary": "Supprime un utilisateur",
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "204": { "description": "Utilisateur supprimé" } }
      }
    },

    "/export/tickets/{id}/pdf": {
      "get": {
        "tags": ["Exportation"],
        "summary": "Exporte un ticket en PDF",
        "produces": ["application/pdf"],
        "parameters": [{ "name": "id", "in": "path", "required": true, "type": "integer" }],
        "responses": { "200": { "description": "PDF généré" } }
      }
    }
  },

  "definitions": {
    "Ticket": {
      "type": "object",
      "properties": {
        "id": { "type": "integer" },
        "title": { "type": "string" },
        "description": { "type": "string" },
        "status": { "type": "string" },
        "priority": { "type": "string" },
        "userId": { "type": "integer" }
      }
    },
    "User": {
      "type": "object",
      "properties": {
        "id": { "type": "integer" },
        "name": { "type": "string" },
        "email": { "type": "string" }
      }
    },
    "Comment": {
      "type": "object",
      "properties": {
        "id": { "type": "integer" },
        "ticketId": { "type": "integer" },
        "authorId": { "type": "integer" },
        "content": { "type": "string" }
      }
    }
  }
}